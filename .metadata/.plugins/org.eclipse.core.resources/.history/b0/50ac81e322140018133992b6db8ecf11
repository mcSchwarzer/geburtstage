package birthdayProjectV2;

import java.time.MonthDay;
import java.time.ZonedDateTime;
import java.time.temporal.ChronoUnit;

public class Person {

	/**add bindings for JSON**/
	
	private String fname;
	private String sname;
	private ZonedDateTime dayOfBirth;
	private long age;
	private int phonenb;
	private String email;

	
	public Person(String fname){
		this.fname = fname;
	}
	public Person(String fname, String sname,ZonedDateTime dayOfBirth, int pnb, String email) throws IllegalArgumentException{
		this.fname = fname;
		this.sname = sname;
		this.dayOfBirth = dayOfBirth;
		this.phonenb = pnb;
		this.email = email;
		this.age = this.calcAge(dayOfBirth);
	}

	private long calcAge(ZonedDateTime bd)throws IllegalArgumentException{
		if(bd.equals(null)){
			throw new IllegalArgumentException("The birthday can't be null! " + this.toString() + "calcAge()");
		}
		return bd.until(ZonedDateTime.now(), ChronoUnit.YEARS);
	}
	
	public boolean hasBirthday()throws IllegalArgumentException{
		MonthDay now = MonthDay.now();
		if(this.dayOfBirth.equals(null)){
			throw new IllegalArgumentException("The birthday can't be null! " + this.toString() + " hasBirthday()");
		}
		if(now.equals(this.dayOfBirthToMonthDay())){
			return true;
		}
		return false;
	}
	
	public MonthDay dayOfBirthToMonthDay(){
		return MonthDay.of(dayOfBirth.getMonthValue(), dayOfBirth.getDayOfMonth());
	}
	
	public String getBirthdayMessage(){
		return ("Hi " + this.fname + ". Alles Gute zum" + this.age + "ten Geburtstag!");
	}
	
	/***
	 * 
	 * @return long : amount of days till the next Birthday or 0 if it is today
	 */
	public long getDaysTillBirthday(){
		ZonedDateTime now = ZonedDateTime.now();
		if(this.dayOfBirth.getDayOfYear() > now.getDayOfYear()){
			return now.until(this.dayOfBirth.plusYears(this.age), ChronoUnit.DAYS);
		}
		else if(this.dayOfBirth.getDayOfYear() == now.getDayOfYear()){
			return 0;
		}
		else{
			return now.until(this.dayOfBirth.plusYears(this.age+1), ChronoUnit.DAYS);
		}
	}


	public String getFname() {
		return fname;
	}
	public String getSname() {
		return sname;
	}
	public ZonedDateTime getDayOfBirth() {
		return dayOfBirth;
	}
	public long getAge() {
		return age;
	}
	public int getPhonenb() {
		return phonenb;
	}
	public String getEmail() {
		return email;
	}
	public void setFname(String fname) {
		this.fname = fname;
	}
	public void setSname(String sname) {
		this.sname = sname;
	}
	public void setDayOfBirth(ZonedDateTime dayOfBirth) {
		this.dayOfBirth = dayOfBirth;
	}
	public void setAge(long age) {
		this.age = age;
	}
	public void setPhonenb(int phonenb) {
		this.phonenb = phonenb;
	}
	public void setEmail(String email) {
		this.email = email;
	}
	
	
	@Override 
	public String toString(){
		return (this.fname + " " + this.sname + ", " + this.age + "( " + this.email + ", " + this.phonenb + " )");
	}
}
