package birthdayProjectV2;

import java.time.MonthDay;
import java.time.ZonedDateTime;
import java.time.temporal.ChronoUnit;

public class Person implements Comparable<Person>{

	/**add bindings for JSON**/
	
	private String fname;
	private String sname;
	private int phonenb;
	private String email;
	private long age;
	private ZonedDateTime dayOfBirth;

	
	public Person(String fname){
		this.fname = fname;
	}
	public Person(String fname, String sname, int pnb, String email, ZonedDateTime zdt) throws IllegalArgumentException{
		this.fname = fname;
		this.sname = sname;
		this.phonenb = pnb;
		this.email = email;
		this.dayOfBirth = zdt;
		this.age = this.calcAge(zdt);
	}

	public long calcAge(ZonedDateTime bd)throws IllegalArgumentException{
		if(bd.equals(null)){
			throw new IllegalArgumentException("The birthday can't be null! " + "calcAge()");
		}
		return bd.until(ZonedDateTime.now(), ChronoUnit.YEARS);
	}
	
	public boolean hasBirthday()throws IllegalArgumentException{
		MonthDay now = MonthDay.now();
		if(this.dayOfBirth.equals(null)){
			throw new IllegalArgumentException("The birthday can't be null! " + " hasBirthday()");
		}
		if(now.equals(dayOfBirthToMonthDay())){
			return true;
		}
		return false;
	}
	
	public MonthDay dayOfBirthToMonthDay(){
		return MonthDay.of(this.dayOfBirth.getMonthValue(), this.dayOfBirth.getDayOfMonth());
	}
	
	public String getBirthdayMessage(){
		return ("Hi " + this.fname + ". Alles Gute zum" + this.age + "ten Geburtstag!");
	}
	
	/***
	 * 
	 * @return long : amount of days till the next Birthday or 0 if it is today
	 */
	public long getDaysTillBirthday(){
		ZonedDateTime now = ZonedDateTime.now();
		return now.until(this.dayOfBirth.plusYears(this.age+1), ChronoUnit.DAYS);
	}


	public String getFname() {
		return fname;
	}
	public String getSname() {
		return sname;
	}
	public int getPhonenb() {
		return phonenb;
	}
	public String getEmail() {
		return email;
	}
	public void setFname(String fname) {
		this.fname = fname;
	}
	public void setSname(String sname) {
		this.sname = sname;
	}
	public void setPhonenb(int phonenb) {
		this.phonenb = phonenb;
	}
	public void setEmail(String email) {
		this.email = email;
	}
	public long getAge() {
		return age;
	}
	public void setAge(long age) {
		this.age = age;
	}
	public ZonedDateTime getDayOfBirth() {
		return dayOfBirth;
	}
	public void setDayOfBirth(ZonedDateTime dayOfBirth) {
		this.dayOfBirth = dayOfBirth;
	}
	@Override 
	public String toString(){
		return (this.fname + " " + this.sname + ", "+ this.dayOfBirth +" ( " + this.email + ", " + this.phonenb + " )");
	}
	@Override
	public int compareTo(Person o) {
		if(this.fname.equals(o.getFname()) && this.sname.equals(o.getSname()) && this.dayOfBirth.isEqual(o.getDayOfBirth())){
			return 0;
		}
		else if(this.getDayOfBirth().getDayOfYear() > o.getDayOfBirth().getDayOfYear()){
			return 2;
		}
		else if(this.getDayOfBirth().getDayOfYear() == o.getDayOfBirth().getDayOfYear()){
			
			if(this.age > o.getAge()){
				return 1;
			}
			else if(this.age < o.getAge()){
				return -1;
			}
			else if(this.age == o.getAge()){
				return this.sname.compareTo(o.getSname());
			}	
		}
		return -2;
	}
}
