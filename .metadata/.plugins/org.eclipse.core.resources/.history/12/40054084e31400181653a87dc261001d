package birthdayProjectV2;

import java.sql.Connection;
import java.sql.DriverManager;
import java.sql.ResultSet;
import java.sql.Statement;

public class DataBase {

	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	public static void main (String[] args){
		Connection c = null;
	      Statement stmt = null;
	      try {
	         Class.forName("org.postgresql.Driver");
	         c = DriverManager
	            .getConnection("jdbc:postgresql://localhost:5432/social","postgres","rfvcde4321");
	         System.out.println("Opened database successfully");

	         stmt = c.createStatement();
	         String sql = "SELECT * FROM person NATURAL JOIN bd_user NATURAL JOIN dayOfBirth WHERE fname = 'Markus'";
	         ResultSet rS = stmt.executeQuery(sql);
	         for(int i = 0;rS.next(); i++){
	        	 System.out.println(rS.getString(i));
	         }
	         stmt.close();
	         c.close();
	      } catch ( Exception e ) {
	         System.err.println( e.getClass().getName()+": "+ e.getMessage() );
	         System.exit(0);
	      }
	      System.out.println("Table created successfully");
	}
}
